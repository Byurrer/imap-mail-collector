## Краткое описание
**imap-mail-collector** – скрипт получения и обработки исходников писем с почтового ящика по imap протоколу.

В файле howto.php показан обработчик сохранения писем: рядом со скриптом создается директория с именем ящика, в которой создается структура директорий с письмами как на почтовом ящике.

## Возможности
Функция ImapMailCollector работает в 2-х режимах:
* подсчет, когда аргумент fnHandler == null (то есть не указан обработчик для найденных сообщений)
* подсчет и обработка писем при помощи обработчика  fnHandler

Если аргумент canDelete == true и fnHandler != null тогда функция обработает найденные письма обработчиком и удалит их.

Обработчик нужен для функции чтобы не создавать промежуточный буфер для накопления данных писем, так как писем может быть неограниченное количество, а ОЗУ ограничена :)

## Использование

	/*! обработчик в случае если найдено сообщение
		@param aMsg массив: [
		  "uid" => уникальный числовой идентификатор сообщения,
		  "raw" => исходник письма,
		  "dir" => директория письма,
		  "email" => email письма
		]
	*/
	function HandlerMail($aMsg)
	{
		...
	}
  
	//сборка писем с передачей данных для imap сервера и обработчика
	$aData = ImapMailCollector("box@domain.zone", "password", "imaps://imap.domain.zone", false, "HandlerMail");
	
	//вернет информацию о ящике
	//$aData = ImapMailCollector("box@domain.zone", "password", "imaps://imap.domain.zone");

Пример ответа:

	Array
	(
		[dirs] => Array
			(
				[0] => INBOX
				[1] => Спам
				[2] => Отправленные
				[3] => Черновики
				[4] => Корзина
			)
		
		[count_msgs] => 325
		[time] => 91.400709152222
	)

## Лицензия
**MIT**

## Автор
Buturlin Vitaliy (Byurrer), email: byurrer@mail.ru
